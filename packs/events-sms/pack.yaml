pack_id: greentic.events.sms
version: 0.1.0
kind: application
publisher: greentic
name: greentic.events.sms
description: Greentic SMS event providers (Twilio)
authors:
  - Greentic Engineering <engineering@greentic.dev>
license: MIT
components:
  - id: events-sms-source
    version: 1.0.0
    world: greentic:events/source@1.0.0
    supports:
      - event
    profiles:
      default: stateless
      supported:
        - stateless
    capabilities:
      wasi:
        clocks: true
      host:
        secrets:
          required:
            - key: TWILIO_AUTH_TOKEN
              required: true
              description: Auth token used to validate Twilio webhook signatures
              scope:
                env: "{{env}}"
                tenant: "{{tenant}}"
              format: text
        events:
          inbound: false
          outbound: true
        http:
          server: true
    wasm: components/stub.wasm
  - id: events-sms-sink
    version: 1.0.0
    world: greentic:events/sink@1.0.0
    supports:
      - event
    profiles:
      default: stateless
      supported:
        - stateless
    capabilities:
      wasi:
        clocks: true
      host:
        secrets:
          required:
            - key: TWILIO_AUTH_TOKEN
              required: true
              description: Auth token used to sign Twilio REST requests
              scope:
                env: "{{env}}"
                tenant: "{{tenant}}"
              format: text
        events:
          inbound: true
          outbound: false
        http:
          client: true
    wasm: components/stub.wasm
  - id: templating.handlebars
    version: 0.0.1
    world: greentic:flow/templating@1.0.0
    supports:
      - messaging
    profiles:
      default: stateless
      supported:
        - stateless
    capabilities:
      wasi:
        clocks: true
        random: true
        filesystem:
          mode: none
          mounts: []
      host:
        messaging:
          inbound: false
          outbound: false
        secrets:
          required: []
        telemetry:
          scope: node
    wasm: components/templating.handlebars/stub.wasm
flows:
  - id: sms-in-default
    file: flows/in_default.ygtc
    entrypoints:
      - sms-in-default
  - id: sms-out-default
    file: flows/out_default.ygtc
    entrypoints:
      - sms-out-default
events:
  providers:
    - name: "sms-in-twilio"
      kind: "source"
      component: "events-sms-source@1.0.0"
      capabilities:
        transport: "twilio"
        reliability: "at_least_once"
        topics:
          - "sms.in.twilio.*"
    - name: "sms-out-twilio"
      kind: "sink"
      component: "events-sms-sink@1.0.0"
      capabilities:
        transport: "twilio"
        reliability: "at_least_once"
        topics:
          - "sms.out.twilio"
